<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru"><head><meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" /><meta name="author" content="Dmitry Hrabrov a.k.a. DeXPeriX" /><link rel="stylesheet" type="text/css" href="../../images/npi.css" title="DeXPeriX Home Page" media="all"/><link rel="stylesheet" type="text/css" href="../../images/ki/articles.css" title="DeXPeriX Home Page additional" media="all" /><style type="text/css" media="all">@import "../../images/npi.css"; @import "../../images/ki/articles.css";</style><title>DeXPeriX Home Page : Статьи > Хакинг > Защита сайта от взлома</title><link rel="alternate" title="DeXPeriX Home Page RSS" href="rss+ru.xml" type="application/rss+xml" /><script type="text/javascript" src="../../images/highlight/highlight.js"></script><script type="text/javascript">initHighlightingOnLoad('html', 'css', 'php', 'xml', 'delphi', 'cpp', 'sql', 'bash');</script></head><body><div id="header"><div id="top"><h1></h1><div id="translate"><ul id="lan"><li class="ru"><a href="anti_web_hack+npi+ru.html" title="ru"><img src="../../images/ki/ru.gif"></a></li><li id="ukazatel" class="clearer"></li><li></li></ul> </div><span>Linux, Hacking, Sources, News, Free Software, Photo and more...</span></div></div><div id="area"><ul id="menu"><li class="Новости"><a href="../../news/index+npi+ru.html" title="Новости"><img src="../../images/ki/home.jpg" alt="Новости" /></a></li><li><a href="../../blog/index+npi+ru.html" id="m1ru" title="Блог"></a></li><li><a href="../../articles/index+npi+ru.html" id="m2ru" title="Статьи"></a></li><li><a href="../../sources/index+npi+ru.html" id="m3ru" title="Исходники"></a></li><li><a href="../../soft/index+npi+ru.html" id="m4ru" title="Программы"></a></li><li><a href="../../projects/index+npi+ru.html" id="m5ru" title="Проекты"></a></li><li><a href="../../tranlations/index+npi+ru.html" id="m6ru" title="Переводы"></a></li><li><a href="../../photo/index+npi+ru.html" id="m7ru" title="Фотоальбом"></a></li><li id="search"><form id="form" action="http://www.google.com/cse" method="get" name="lse" class="lse"><input type="hidden" name="cx" value="015301063631066860216:x64p4f5z3o8" /><input type="hidden" name="ie" value="UTF-8" /><input class="text" type="text" name="q" value=""/><input class="sub" type="submit" value="" name="sa"></form></li></ul><div id="content"><div id="bg_right"><div id="topic"><div id="line"></div><h2>Защита сайта от взлома</h2> <div id="topic-list"><div id="contdata"><p>В сети довольно много статей о взломе сайтов, о социальной инженерии, как о способе нападения. Довольно много сайтов, где можно скачать эксплоит на тот или иной скрипт. Однако статей, как от этого всего защититься, довольно мало. Я решил исправить этот недостаток и написал эту статью.
</p><p>Сегодня мы научимся пользоваться социальной инженерией. А кто сказал, что её можно применять только при нападении? <img src="../../images/smilies/wink.png" align="top" height="20" width="20" title=";)" alt=";)" /> Сегодня мы будем при её помощи очень даже успешно защищаться! Говоря простым языком, социальная инженерия - развод лохов, т.е. фальсификация какой-либо информации и использование её в "нехороших" целях. Наверняка вам приходили сообщения типа: "Дайте нам ваш пароль от инета и будет вам счастье!". Это, конечно, немного утрированное сообщение - обычно такие сообщения очень тщательно пишутся и ложь всякими способами скрывается. Однако, большинство из нас с этим встречались и знают, что такое социальная инженерия. А почему бы нам не использовать что-то типа этого против тех, кто хочет нас взломать?
</p><p>Для начала элементарные правила защиты. Над всем должен быть установлен жесточайший контроль, т.е. даже если есть какое-то маленькое незначительное поле ввода, которое почти ни на что не влияет, его обязательно нужно проверить, т.к. через такие мелкие дырки в основном и осуществляется взлом сайтов. Если вводится число - проверьте его границы (если оно должно не превышать что-то или, например, быть положительным). Если на вводе должны быть только целые числа - сразу берите число типа <b>int</b>, обрезая не числа. Если на вводе строка (не число) по возможности удаляйте <b>html</b> и <b>php</b> теги (<b>htmlspecialchars</b> и <b>strip_tags</b> вам в помощь <img src="../../images/smilies/smile.png" align="top" height="20" width="20" title=":)" alt=":)" /> ). Где это возможно, старайтесь не отображать информацию в том виде, в каком её ввел пользователь. Т.е., например, вместо "<i>по запросу: < текст запроса > ничего найдено.</i>" лучше написать "<i>по Вашему запросу ничего не найдено.</i>", т.к. есть вероятность, что пользователь ввёл зловредный скрипт и он полностью выполнится и отобразится на странице. Даже если вы уверены, что всё обработали и просчитали, помните - бережёного бог бережёт, т.е. лишняя осторожность не помешает.
</p><p>Чем меньше данных пользователь может залить к вам на сайт, тем меньше вероятность, что он зальёт вредоносный скрипт. Предположим, что у Вас есть форум, на который все пользователи могут заливать свои фотографии. Но если не проверять закачиваемые файлы, юзер с лёгкостью сможет залить на ваш сайт файл <i>hack.php</i>, который всё взломает. Запомните, возможность исполнения чужеродных скриптов на сайте равносильна полному контролю над сайтом! Т.е. как минимум нужно запретить закачивать файлы с расширением .php . А ещё лучше константно записать все разрешённые расширения файлов, до определённого уровня ограничить размер заливаемого файла и, в конце концов, везде вырезать теги.
</p><p>Ну вот, теперь сайт уже немного защищён. А теперь прикинемся белыми, пушистыми, нихрена не знающими ламерами! На самом деле, взлом сайта довольно тяжёлая задача. Она требует прекрасных знаний языков, на которых написан данный сайт, логическое мышление и опыт. Далеко не все, кто считают себя хакерами, реально смогут взломать сайт. Теперь представим такую ситуацию: кто-то написал очень хороший, мощный движок сайта/форум. Очень много людей установило к себе на сайт эту прекрасную вещь. А какой-то хакер взломал этот движок/форум и написал универсальную программу для взлома данного типа программ (так называемый, експлоит [exploit] ). Теперь любой ламер может скачать этот эксплоит и несколькими кликами мыши взломать огромное количество сайтов. Чаще всего такие "хакеры", которые только и умеют, что использовать чужие программы, и встречаются на просторах всемирной сети. Они видят надпись "Invision Power Board" (или подобную), достают эксплоит, выполняют его и вуаля - сайт хакнут! Кстати, так делают даже профессиональные хакеры - вовсе необязательно взламывать форум, если он уже взломан и нужно всего лишь почитать мануал (инструкцию) по взлому или скачать эксплоит.
</p><p>Пускай у нас есть цель: сделать сайт  с форумом. Причём, сайт мы кое-как уже написали и некоторые странички динамически генерируются, а вот с форумом проблема. Выбор форума очень ответственен. В бесплатных каталогов скриптов их довольно много - выбирай на любой вкус. Нужно выбрать несколько, а потом попробовать поискать в сети информацию о взломе этих форумов (мануалы), эксплоиты на них. Выбираем тот форум, который душе ближе и в котором меньше всего дырок. Желательно, чтоб он не отличался какими-нибудь сверхъестественными способностями и не был уж очень большим. А теперь вся хитрость фокуса: попытаемся выдать наш форум за какой-нибудь другой! Приходит "хакер" к вам на сайт, видит знакомую модель форума, запускает сплоит, а тот посылает его куда подальше и говорит что форум не хакаем! <img src="../../images/smilies/biggrin.png" align="top" height="20" width="20" title=":D" alt=":D" /> Вот смеху-то будет! <img src="../../images/smilies/smile.png" align="top" height="20" width="20" title=":)" alt=":)" />
</p><p> Для того, чтобы выдать форум за другой, нужно хотя бы изменить его внешний вид. Чем реальнее Вы сможете сделать, тем лучше. Для этого я сохранил одну из страниц Invision Power Board (IPB) форума на винт и выдрал оттудова всю нужную мне информацию. Потом заменил старый внешний вид моего форума на вид IPB. Invision Power Board использует MySQL базу данных, в то время как форум, который выбрал я, все данные хранит в файлах. НИКАКОЙ эксплоит, рассчитанный на IPB мне не страшен. Также я полностью стёр информацию о том, какой форум на самом деле установлен, т.е. нельзя просто прийти на яндекс и спросить о взломе конкретной модели моего форума. Теперь если кто-то и захочет взломать форум, то ему придётся самостоятельно его изучать и искать дырки. Причём, если раньше он мог просто найти такую же модель форума, скачать её, и уже в исходниках искать дыры, то теперь этой возможности у взломщика нет...
</p><p></p><p>Да, кстати, я надеюсь, вы не забыли профиксить баги своего форума, которые есть в сети? <img src="../../images/smilies/wink.png" align="top" height="20" width="20" title=";)" alt=";)" />
</p><p></p><p>Ну вот, форум защитили. Теперь приступим к защите сайта. Здесь также можно провернуть похожий финт - выдать один движок за другой. Однако, довольно часто движки сайтов отличаются не только внешним видом, так что сделать подмену инфы будет тяжелее.  Обязательно удалите информацию о версии и типе движка. Даже там, где у вас статические страницы, сделайте вид, как будто они динамические, т.е. данные типа время генерации страницы и т.д., передавайте туда какие-нибудь параметры - пускай взломщик ломает статическую страницу, нам что, жалко что ли? Ведь её взломать невозможно! <img src="../../images/smilies/biggrin.png" align="top" height="20" width="20" title=":D" alt=":D" />
</p><p>Если ваш движок не использует БД можно выдавать строку типа: "Запросов к MySQL ..." и писать какое-нибудь число <img src="../../images/smilies/smile.png" align="top" height="20" width="20" title=":)" alt=":)" /> Пускай хакер ещё и MySQL дыры поищет - практиковаться полезно! <img src="../../images/smilies/biggrin.png" align="top" height="20" width="20" title=":D" alt=":D" />
</p><p>Ещё одним важным моментом является администраторская панель. Она - цель хакера. А что нам мешает положить на самое видное место файл <b>admin.php</b>, в котором будет находиться лже-админка? <img src="../../images/smilies/wink.png" align="top" height="20" width="20" title=";)" alt=";)" /> Внешне она должна быть максимально похожа на реальную, а при вводе данных говорить "<i>Введённые данные не верны</i>". Будет очень смешно, если кто-то решит перебором подобрать пароль к такой админке! <img src="../../images/smilies/biggrin.png" align="top" height="20" width="20" title=":D" alt=":D" /> .
</p><p>Настоящая же админка должна находиться реально глубоко, например, в папке <i>/downloads/games/</i> а сам файл админки должен называться, например, <i>tetris.php</i>, причём, при запуске админки без определённого параметра должен реально запускаться какой-нибудь JavaScript тетрис. Чтобы  отвести подозрения, хорошо бы чтоб в данной папочке лежала ещё кучка JavaScript игр с расширением .php . Кто подумает, что там запрятана админка? Да никто... А вот вы в любую минуту сможете ввести <a href="http://your_site.com/downloads/games/tetris.php?a=not_hacker" target="blank">http://your_site.com/downloads/games/tetris.php?a=not_hacker</a> или что-то в этом роде. Не забывайте, авторизация пользователя всё равно обязательно должна присутствовать!
</p><p>И на последок ещё одна частая ошибка веб-программиста. Вот пример запроса:
</p><p><a href="http://some_site.com/news.php?file=26.02.2006-news.txt" target="blank">http://some_site.com/news.php?file=26.02.2006-news.txt</a>
</p><p>А вот как некоторые программисты обрабатывают данный запрос (приведён файл news.php):
</p><p><div class="codedtop">PHP код:</div><div class="coded"><pre><code>&lt;?php
  include($file);
?></code></pre></div>
</p><p>Во-первых, никакой проверки информации. Во-вторых файл не обязательно будет нужным, т.е. например:
</p><p><a href="http://some_site.com/news.php?file=forum/data/hack.php" target="blank">http://some_site.com/news.php?file=forum/data/hack.php</a>
</p><p>Где hack.php - заранее залитый файл, либо файл с другого сервера. Т.е. по возможности никогда не подключайте файлы, переданные адресной строкой. Старайтесь это каким-нибудь образом обойти. Если обойти не получается - обязательно это контролируйте самым строжайшим образом!
</p><p>Ну вот мы и научились некоторым приёмам защиты своего сайта. Некоторые из данных советов похожи на советы параноика: изменить внешний вид форума очень даже не просто. Однако, почти везде я старался объяснить зачем мы проводили те или иные действия. Рассмотрены далеко не все способы защиты - даже если вы и сделали всё, что в этой статье написано, это ещё не значит, что вас не хакнут. Настоящего хакера не остановит ни что...</p></div><br /><p class="plink"><a href="anti_web_hack+ru.pdf">Скачать в формате PDF</a> (126.1 kB)</p><h2 id="comments">Комментарии</h2><div id="title"><h3>дима</h3><span>24.03.2006</span></div><div id="text"><p>норм статья</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3>12&#39;&gt;M</h3><span>29.05.2007</span></div><div id="text"><p>12&#39;&gt;&lt;h10&gt;M&lt;/h10&gt;</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3><img src="../../images/flags/BY.gif" width="30" height="15" alt="BY" title="BY" /> DeXPeriX</h3><span>29.05.2007</span></div><div id="text"><img src="../../images/avatars/dexperix.jpg" class="preview" width="104" height="150" alt="DeXPeriX" title="DeXPeriX" /><p>to  <B>12&#39;&gt;M</B> (IP=91.149.178.54) Думаю, глупо было пытаться использовать те дыры, про которые написано в статье. На моём сайте всё самописанное и указанные ошибки я учёл.P.S. SQL мой движок действительно не юзает <img src="../../images/smilies/smile.png" align="top" height="20" width="20" alt="(smile)"/>)Грубо говоря, в статье рассмотрена некоторая часть защиты моего сайта. И написано, что эти ошибки учтены. Так что ты, юный хакер, если знаешь как взломать мой сайт, но этот спопоб уже описан в одной изх моих статей, знай - это тебе врядли удастся <img src="../../images/smilies/smile.png" align="top" height="20" width="20" alt="(smile)"/>))</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3>Wergery</h3><span>08.07.2007</span></div><div id="text"><p>я так понял, что если на сайте нет динамических страниц (форумов, и прочих .php), а только .html , в котором нет ни одной формы - то такой сайт не хакается?</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3><img src="../../images/flags/BY.gif" width="30" height="15" alt="BY" title="BY" /> DeXPeriX</h3><span>09.07.2007</span></div><div id="text"><img src="../../images/avatars/dexperix.jpg" class="preview" width="104" height="150" alt="DeXPeriX" title="DeXPeriX" /><p>Wergery, ты всё понял правильно. Формы даже могут быть - если ты их не обрабатываешь через РНР и другие языки. Только тогда толку от них... Да, тогда через твой сайт взлома быть не может. Но у твоего хостера наверняка есть скриптовые странички (типа, регистрации пользователей, панели управления сайтом и т.п.). Можно взломать их и автоматически получить доступ к твоему сайту. Также помни, что сервер хостинга - самый обычный компьютер. На нём стоит операционная система. В ней тоже могут быть дыры. На хостенги стоит ещё туева куча программ, в которых могут быть дыры. От взлома полностью не застрахован никто...</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3>Wergery</h3><span>10.07.2007</span></div><div id="text"><p>Спасибо за ответ<img src="../../images/smilies/wink.png" align="top" height="20" width="20" alt="(wink)"/> из последнего: если мой хостер - я, а сервер обычный комп (можно даже на Unix) с фаерволом, открывающим только 80 порт.. то как тогда?</p></div><div id="next_comm">&nbsp;</div><div id="title"><h3><img src="../../images/flags/BY.gif" width="30" height="15" alt="BY" title="BY" /> DeXPeriX</h3><span>10.07.2007</span></div><div id="text"><img src="../../images/avatars/dexperix.jpg" class="preview" width="104" height="150" alt="DeXPeriX" title="DeXPeriX" /><p>Смотря что будет висеть на этом 80 порту. Во многих mod&#39;улях апача постоянно находят дырки. + ядро должно быть свежее + файрвол настроить толково нужно. Тем не менее, если машина твоя - то она очень легко загнётся от DDoS атаки</p></div><div id="next_comm">&nbsp;</div><div id="contdata"><h2 id="commentsform">Оставить комментарий</h2><form method="post" name="comment_form" id="comment_form" action="http://dexperix.net/scripts/comment.php"><table border="0"><tr><td><input type="hidden" name="id" value="24" /><input type="hidden" name="uid" value="53" />Имя (ник):</td><td><input type="text" name="nick" size="40" maxlength="35" /></td></tr><tr><td colspan="2"><small>( Ваш ник или реальное имя. Будет показано в заголовке комментария )</small></td></tr><tr><td>E-Mail:</td><td><input type="text" name="mail" size="40" maxlength="35" /></td></tr><tr><td colspan="2"><small>( Ваш e-mail. Используется только для связи с Вами администрации. Показан НЕ будет )</small></td></tr><tr><td>Сайт, ICQ или Jabber:</td><td><input type="text" name="site" size="40" maxlength="35" /></td></tr><tr><td colspan="2"><small>( Это поле будет отображено в заголовке комментария рядом с Вашим именем )</small></td></tr><tr><td>Ваша оценка:</td><td><select name="rathing" size="1"><option value="0" selected="selected">Нет оценки</option><option value="1">Ужасно</option><option value="2">Плохо</option><option value="3">Нормально</option><option value="4">Хорошо</option><option value="5">Отлично</option></select></td></tr><tr><td colspan="2"><small>( Как Вы оцениваете данный материал? По умолчанию оценка не ставится )</small></td></tr><tr><td colspan="2">Введите число, изображённое на картинке <img src="http://dexperix.net/scripts/image.php?id=24" width="90" height="30" align="middle" class="captcha" alt="Image" /> : <input type="text" name="captcha" size="8" maxlength="7" /></td></tr><tr><td colspan="2">Текст комментария:</td></tr><tr><td colspan="2" align="center"><textarea name="text"></textarea><br /><input type="submit" value="Оправить комментарий" /></td></tr></table></form></div><div id="reklama"><!--ADVERT_TEMPLATE--></div></div> </div><div id="topic_left"><div id="line_l"></div><div id="info_left"><h3>Дизайн</h3><ul id="l_info"><li><a href="anti_web_hack+blp+ru.html">:: Black Purple</a></li><li><a href="anti_web_hack+gray+ru.html">:: Gray Text</a></li><li><a href="anti_web_hack+npi+ru.html">:: New Pictures</a></li></ul><h3>Друзья</h3><ul id="l_info"><li><a href="http://coderszone.info" target="_blank">:: CodersZone.Info</a></li></ul><h3>Счётчики</h3><ul id="l_info"><li><!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t24.5;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: showed number of visiters"+
" today' "+
"border=0 width=88 height=15><\/a>")//--></script><!--/LiveInternet--></li><li><!-- MyCounter v.2.0 -->
<script type="text/javascript"><!--
my_id = 3456;
my_width = 69;
my_height = 14;
my_alt = "MyCounter - Ваш счётчик";
//--></script>
<script type="text/javascript"
  src="http://scripts.mycounter.com.ua/counter2.0.js">
  </script><noscript>
<div>  <a href="http://mycounter.com.ua/"><img
  src="http://get.mycounter.com.ua/counter.php?id=3456"
  title="MyCounter - Ваш счётчик"
  alt="MyCounter - Ваш счётчик"
  width="69" height="14" /></a></div></noscript>
</li></ul></div></div></div><div id="paw"></div></div><div id="add_menu"><ul id="menu_right"><li><a href="../alg/index+npi+ru.html" id="algru" title="Алгоритмы"></a></li><li><a href="../linux/index+npi+ru.html" id="linuxru" title="Linux"></a></li><li><a href="../delphi/index+npi+ru.html" id="delphiru" title="Delphi"></a></li><li><a href="../php/index+npi+ru.html" id="phpru" title="PHP кодинг"></a></li><li><a href="../hack/index+npi+ru.html" id="hackru" title="Хакинг"></a></li><li><a href="../track-music/index+npi+ru.html" id="track-musicru" title="Музыка"></a></li><li><a href="../diz/index+npi+ru.html" id="dizru" title="Дизайн"></a></li><li><a href="../instr/index+npi+ru.html" id="instrru" title="Инструкции"></a></li><li><a href="../other/index+npi+ru.html" id="otherru" title="Другие"></a></li></ul></div></div><div id="bottom"><div id="footer"><ul id="f_left"><li class="ukz"></li><li class="copyright">Copyright &copy; <span>2005-2009</span> by  <a href="http://dexperix.net">DeXPeriX</a></li></ul><ul id="f_right"><li class="icq">606 - 986</li><li class="jabber"><a>root<span>@</span>dexp.in</a></li></ul></div></div></body></html>